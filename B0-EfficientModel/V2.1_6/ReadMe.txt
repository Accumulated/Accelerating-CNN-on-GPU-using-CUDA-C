Some function optimized and code refactoring is doen. The code now contians 3 .cu files, they all compile
using nvcc. Timing for the whole model is now 9.5 msec